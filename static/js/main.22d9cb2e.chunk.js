(this["webpackJsonpbidi-viewer"]=this["webpackJsonpbidi-viewer"]||[]).push([[0],{34:function(e,t,n){},55:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),r=n(26),s=n.n(r),i=(n(34),n(16)),l=n.n(i),u=n(27),j=n(29),d=n(8),h=n(61),o=n(62),b=n(63),O=n(64),x=n(65),m=n(66),g=n(67),p=n(28),f=n.n(p),v=n(17),N=(n(54),n(55),n(1)),L=/(^[^\n]*'[^\n]*[\u2066\u2067\u2068][^'\u2069\n]*'[^\n]*$|^[^\n]*'[^\n]*[\u202A\u202B\u202D\u202E][^'\u202C\n]*'[^\n]*$|^[^\n]*"[^\n]*[\u2066\u2067\u2068][^"\u2069\n]*"[^\n]*$|^[^\n]*"[^\n]*[\u202A\u202B\u202D\u202E][^"\u202C\n]*"[^\n]*$|^[^\n]*\/\*[^\n]*[\u2066\u2067\u2068][^\u2069\n]*\*\/[^\n]*$|^[^\n]*\/\*[^\n]*[\u202A\u202B\u202D\u202E][^\u202C\n]*\*\/[^\n]*$|^[^\n]*\/\/[^\n]*[\u2066\u2067\u2068][^'\u2069\n]*$|^[^\n]*\/\/[^\n]*[\u202A\u202B\u202D\u202E][^'\u202C\n]*$|^[^\n]*#[^\n]*[\u2066\u2067\u2068][^'\u2069\n]*$|^[^\n]*#[^\n]*[\u202A\u202B\u202D\u202E][^'\u202C\n]*$)/gm,y=[["\u202c","PDF"],["\u202a","LRE"],["\u202b","RLE"],["\u202d","LRO"],["\u202e","RLO"],["\u2069","PDI"],["\u2066","LRI"],["\u2067","RLI"],["\u2068","FSI"],["\u200e","LRM"],["\u061c","ALM"]];function C(e){if(!e)return-1;for(var t=1,n=0;n<e.index;n++)"\n"===e.input[n]&&t++;return t}function w(e){for(var t,n=null!==(t="string"===typeof e?[e]:e)&&void 0!==t?t:[],c=0;c<y.length;c++)for(var a=Object(d.a)(y[c],2),r=a[0],s=a[1],i=0;i<n.length;i++){var l=n[i];if("string"===typeof l&&l.includes(r)){for(var u=l.split(r),h=1;h<u.length;)u.splice(h,0,Object(N.jsx)("span",{className:"bidi",children:s})),h+=2;return n.splice.apply(n,[i,1].concat(Object(j.a)(u))),w(n)}}return Object(N.jsx)(N.Fragment,{children:n.map((function(e){return"string"===typeof e?Object(N.jsx)("span",{children:e}):e}))})}var R=function(){var e=Object(c.useRef)(""),t=Object(c.useRef)(null),n=Object(c.useState)([]),a=Object(d.a)(n,2),r=a[0],s=a[1],i=Object(c.useState)(0),j=Object(d.a)(i,2),p=j[0],y=j[1],R=Object(c.useState)([]),B=Object(d.a)(R,2),F=B[0],k=B[1];Object(c.useEffect)((function(){null!==t.current&&t.current.destroy(),y((function(e){return Math.max(Math.min(e,r.length-1),0)})),p<r.length?(e.current="",k([["","Loading..."]]),Object(u.a)(l.a.mark((function e(){var t,n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get(r[p]);case 3:for(t=e.sent,c=[];null!==(n=L.exec(t.data));)c.push([C(n),n[0]]);c.length?k(c):r.length?k([["","No Bidi characters detected."]]):k([["",""]]),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),k([["","An error ocurred loading the requested URL."],["",e.t0.response.data]]);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()):k([["",""]])}),[r,p,k]);var E=function(){y(Math.min(p+1,r.length-1))},$=function(){y(Math.max(p-1,0))};return Object(v.a)("left",$,{},[p]),Object(v.a)("right",E,{},[p,r]),Object(N.jsxs)("div",{className:"App",children:[Object(N.jsx)(h.a,{color:"light",light:!0,expand:"md",children:Object(N.jsx)(o.a,{children:Object(N.jsxs)(b.a,{href:"/",children:["Bidi Viewer ",Object(N.jsx)("small",{className:"text-muted",children:"- a tool for bulk-analyzing raw online code for Trojan Source attacks"})]})})}),Object(N.jsxs)(o.a,{children:[Object(N.jsxs)(O.a,{className:"mt-4",style:{height:"42vh"},children:[Object(N.jsx)(x.a,{md:4,className:"h-100",children:Object(N.jsx)(m.a,{type:"textarea",placeholder:"Enter newline-separated URLs pointing to code...",onChange:function(e){return s(e.target.value?e.target.value.split("\n"):[])},style:{height:"100%"}})}),Object(N.jsxs)(x.a,{md:8,className:"code-area h-100",children:[Object(N.jsx)("h6",{className:"text-muted pt-3",children:"Rendered Lines with Bidi Control Characters"}),Object(N.jsx)("hr",{}),Object(N.jsx)("code",{children:F.map((function(e){var t=Object(d.a)(e,2),n=t[0],c=t[1];return""===n?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("span",{className:"lineNum",children:c}),Object(N.jsx)("br",{})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("span",{className:"lineNum",children:[n,": "]}),Object(N.jsx)("span",{children:c}),Object(N.jsx)("br",{})]})}))})]})]}),Object(N.jsxs)(O.a,{className:"mt-2",style:{height:"42vh"},children:[Object(N.jsxs)(x.a,{md:4,className:"h-100",children:[Object(N.jsx)("div",{className:"pt-4",children:r.length?"".concat(p+1,"/").concat(r.length):"0/0"}),Object(N.jsx)("div",{className:"pt-4",style:{minHeight:"30vh",wordWrap:"break-word"},children:r?Object(N.jsx)("a",{href:r[p],target:"_blank",rel:"noreferrer",children:r[p]}):"No source selected."}),Object(N.jsx)(g.a,{style:{float:"right",marginLeft:"10px"},onClick:E,disabled:p>=r.length-1,children:">"}),Object(N.jsx)(g.a,{style:{float:"right"},onClick:$,disabled:p<=0,children:"<"})]}),Object(N.jsxs)(x.a,{md:8,className:"code-area h-100",children:[Object(N.jsx)("h6",{className:"text-muted pt-3",children:"Bidi Visualization"}),Object(N.jsx)("hr",{}),Object(N.jsx)("code",{children:F.map((function(e){var t=Object(d.a)(e,2),n=t[0],c=t[1];return""===n?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("span",{className:"lineNum",children:c}),Object(N.jsx)("br",{})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("span",{className:"lineNum",children:[n,": "]}),w(c),Object(N.jsx)("br",{})]})}))})]})]})]})]})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};s.a.render(Object(N.jsx)(a.a.StrictMode,{children:Object(N.jsx)(R,{})}),document.getElementById("root")),B()}},[[59,1,2]]]);
//# sourceMappingURL=main.22d9cb2e.chunk.js.map